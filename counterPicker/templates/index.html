<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dota 2 Counter Picker</title>
    <style>
        /* Styling the search input to be aligned with dropdown */
        .search-container {
            margin-bottom: 20px;
        }
    </style>
    <script>
        // Function to filter the dropdown options based on search input
        function filterHeroes(searchText, selectElement) {
            const options = selectElement.getElementsByTagName('option');
            for (let option of options) {
                if (option.text.toLowerCase().includes(searchText.toLowerCase())) {
                    option.style.display = 'block';
                } else {
                    option.style.display = 'none';
                }
            }
        }

        // Event listener for search input to filter options
        function createSearchInput(selectElement) {
            const searchContainer = selectElement.parentNode.querySelector('.search-container');
            if (!searchContainer) return;

            const searchInput = document.createElement('input');
            searchInput.type = 'text';
            searchInput.placeholder = 'Search for heroes...';
            searchInput.addEventListener('input', function () {
                filterHeroes(searchInput.value, selectElement);
            });
            searchContainer.appendChild(searchInput);
        }

        // Wait for the DOM to load before creating search fields for each dropdown
        window.onload = function () {
            const selects = document.querySelectorAll('select');
            selects.forEach(select => createSearchInput(select));
        };
    </script>
</head>
<body>
    <h1>Dota 2 Counter Picker</h1>
    
    <!-- Hero Select Form -->
    <form method="POST">
        <label>Select up to 5 Enemy Heroes:</label><br><br>

        {% for i in range(1, 6) %}
        <label for="hero_{{ i }}">Hero {{ i }}:</label>
        <input type="text" list="hero-list-{{ i }}" name="hero_{{ i }}" id="hero_{{ i }}" autocomplete="off" placeholder="Type to search...">
        
        <datalist id="hero-list-{{ i }}">
            {% for id, name in hero_names.items() %}
            <option value="{{ name }}"></option>
            {% endfor %}
        </datalist>
        <br><br>
        {% endfor %}

        <button type="submit">Calculate Best Picks</button>
    </form>


    <!-- Display Results if Hero is Selected -->
    {% if matchups %}
    <h2>Best Counters Against: {{ ", ".join(selected_heroes) }}</h2>
    <ul>
        {% for hero, score in matchups %}
        <li>{{ hero }} â€” Advantage Score: {{ "%+.2f"|format(-score) }}</li>
        {% endfor %}
    </ul>
    {% endif %}

    <!-- Display Error Message if Hero Not Found -->
    {% if error %}
        <p style="color:red">{{ error }}</p>
    {% endif %}
</body>
</html>
